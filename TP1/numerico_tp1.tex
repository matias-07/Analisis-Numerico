\documentclass[titlepage,a4paper]{article}

\usepackage{a4wide}
\usepackage[colorlinks=true,linkcolor=black,urlcolor=blue,bookmarksopen=true]{hyperref}
\usepackage{bookmark}
\usepackage{fancyhdr}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{color}
 
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
 
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
 
\lstset{style=mystyle}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{TP1 - Grupo 5}
\fancyhead[R]{Análisis Numérico I - FIUBA}
\renewcommand{\headrulewidth}{0.4pt}
\fancyfoot[C]{\thepage}
\renewcommand{\footrulewidth}{0.4pt}


\begin{document}


\begin{titlepage}
	\hfill\includegraphics[width=6cm]{logofiuba.jpg}
    	\centering
    	\vfill
	\huge \textbf{Análisis Numérico I\\}
	\huge \textbf{[75.12/95.04]\\}
	\huge \textbf{Curso 3\\}
    	\huge \textbf{Trabajo Práctico 1}
    	\vskip2cm
	\large
	Grupo 5 \\
    	Primer cuatrimestre de 2019 
	\vfill

	\begin{tabular}{ |l|l|l| }
		\hline
		\multicolumn{3} { |c| } {\textbf{Integrantes del grupo}} \\ \hline
		Santa María Tomás & padron & mail\\ \hline
	 	Hemmingsen Lucas & 76187 & lhemmingsen@fi.uba.ar\\ \hline
	 	Huenul Matías & 102135 & matias.huenul.07@gmail.com\\ \hline
	\end{tabular}
	\vfill
    	\vfill
\end{titlepage}


\section{Introducción}\label{sec:introd}
El objetivo del presente trabajo práctico es obtener aproximaciones de dos funciones y utilizarlas para calcular su valor en distintos puntos, estimando los errores cometidos en ambos casos y analizando las causas de los mismos en base a los conceptos teóricos vistos en el curso.


\section{Conceptos teóricos}\label{sec:conceptos}
\begin{description}
\item[Teorema de Taylor] Este teorema permite obtener aproximaciones polinomiales de funciones diferenciables en un cierto entorno, así también como una cota para el error de aproximación. Sea $ k \geq 1 $ un número entero y $ f(x) $ una función $k$ veces diferenciable en $ x_0 $, su polinomio de Taylor de orden $ k $ en torno a $  x_0 $ se define como:
	\begin{equation}
	P_k(x) = \sum_{i=0}^k \frac{f^{(i)}(x_0)}{i!}(x - x_0)^i
	\end{equation}
y el error que se comete aproximando $ f(x) $ a través de $ P_k(x) $ es:
	\begin{equation}
	R_k(x) = \frac{f^{(k+1)}(c)}{(k+1)!}(x - x_0)^{k+1}
	\end{equation}
donde $c \in [x_0, x]$ o $c \in [x, x_0]$. 
\end{description}


\section{Parte 1}\label{sec:parte1}
El segundo polinomio de Taylor de la función $ f(x) = e^xcos(x) $ alrededor de $ x_0 = \frac{\pi}{6} $ es:
	\begin{equation}
	P_2(x) = \frac{1}{2}\sqrt{3}e^{\frac{\pi}{6}} + \frac{1}{2}(\sqrt{3} - 1)e^{\frac{\pi}{6}}(x - \frac{\pi}{6}) - \frac{1}{2}e^{\frac{\pi}{6}}(x - \frac{\pi}{6})^2
	\end{equation}
Utilizando este polinomio para aproximar $ f(x) $ en $ x = 0.5 $ se obtiene:
	\begin{equation}
	f(0,5) \approx P_2(0,5) = 1,4469
	\end{equation}
El error estará dado por:
	\begin{equation}
	R_2(x) = \frac{-2e^{x}(sen(c) + cos(c))}{6}(x - \frac{\pi}{6})^3
	\end{equation}
Luego el error cometido al realizar la aproximación es:
	\begin{equation*}
	R_2(0,5) = 7,2226*10^{-6}(sen(c) + cos(c))
	\end{equation*}
	\begin{equation*}
	| R_2(0,5) | \leq 7,2226*10^{-6}(|sen(c)| + |cos(c)|) \leq 7,2226*10^{-6}*2
	\end{equation*}
	\begin{equation}
	| R_2(0,5) | \leq 1.4445*10^{-5}
	\end{equation}
La cota superior del error de aproximación de $ f(x) $ al usar $ P_2(x) $ en el intervalo $ [0, 1] $ es:
	\begin{equation*}
	| R_2 | \leq | \frac{-2e^{1}(sen(c) + cos(c))}{6}(1 - \frac{\pi}{6})^3 |
	\end{equation*}
	\begin{equation}
	| R_2 | \leq 0,19594
	\end{equation}
Al evaluar en Octave se obtiene $ f(0,5) = 1,4469 $. Este resultado coincide con el calculado mediante la aproximación, lo cual es esperable ya que de acuerdo a $(6)$, $P_2(x)$ logra aproximar a $f(x)$ hasta cuatro decimales sin error y por lo tanto, al redondear simétricamente como lo hace Octave, se llega al mismo valor.

\section{Parte 2}\label{sec:parte2}
	\begin{enumerate}[label=(\alph*)]
		\item 
			El primer método que utilizaremos para aproximar la función error\cite{error_function} será desarrollar la serie de Taylor 
			de $e^{-x^2}$ alrededor de $x=0$ y luego aplicaremos la integral definida a cada término de la serie y 
			lo multiplicaremos por $2/\sqrt{\pi}$.\\
			Sabiendo que el desarrollo de Taylor de $e^x$ alrededor del cero es:
				\begin{equation}
					e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + ... = \sum_{k=0}^{\infty}\frac{x^k}{k!}
				\end{equation}
			Sustituyendo para $e^{-x^2}$:
				\begin{equation}
					e^{-x^2} = 1 - x^2 + \frac{x^4}{2!} - \frac{x^6}{3!} + ... = \sum_{k=0}^{\infty}\frac{(-1)^k x^{2k}}{k!}
				\end{equation}
			Integrando cada término:
				\begin{equation}
					\int_{0}^{x}e^{-t^2}dt= x - \frac{x^3}{3} + \frac{x^5}{5\cdot2!} - \frac{x^7}{7\cdot3!} + ... = \sum_{k=0}^{\infty}\frac{(-1)^k x^{2k+1}}{(2k+1)\cdot k!}
				\end{equation}
			Y finalmente, multiplicando por $2/\sqrt{\pi}$ obtenemos:
				\begin{equation}
					erf(x) = \frac{2}{\sqrt{\pi}}\int_{0}^{x}e^{-t^2}dt = \frac{2}{\sqrt{\pi}}\sum_{k=0}^{\infty}\frac{(-1)^k x^{2k+1}}{(2k+1)\cdot k!}
				\end{equation}

			Como calcularemos un número limitado de términos de esta serie, tendremos un error de truncamiento, que estará dado por:


			Como segundo método, aproximaremos la integral de la función error con el método del trapecio\cite{burden1}. 
			En particular, utilizaremos el método del trapecio compuesto\cite{burden2}, con el que podremos ir variando 
			la precisión del resultado según la cantidad de subintervalos utilizados para calcular la integral.

			La regla del trapecio compuesta para $n$ subintervalos para una función $f(x)$ en un intervalo $[a,b]$ está dada por:
				\begin{equation}
					\int_{a}^{b}f(x)dx = \frac{h}{2}\left[f(a) + 2\sum_{j=1}^{n-1}f(x_{j})+f(b)\right]-\frac{b-a}{12}h^{2}f''(\mu)
				\end{equation}
			donde $h=(b-a)/n$ es el tamaño de cada subintervalo y $x_j = a + jh$ para cada $j=1,2,..,n$. El último 
			término corresponde al error del método donde $\mu \in (a,b)$.

			Para nuestra función error, siendo $f(x) = e^{-x^2}$ tenemos:
				\begin{equation}
					\int_{0}^{b}e^{-x^2}dx = \frac{h}{2}\left[1 + 2\sum_{j=1}^{n-1}e^{-{x_j}^2}+e^{-b^2}\right]-\frac{b}{12}h^{2}f''(\mu)
				\end{equation}
			Finalmente, multiplicando por $2/\sqrt{\pi}$ obtenemos nuestra segunda aproximación de la función error:
				\begin{equation}
					erf(x) = \frac{2}{\sqrt{\pi}}\int_{0}^{x}e^{-t^2}dt \simeq \frac{h}{\sqrt{\pi}}\left[1 + 2\sum_{j=1}^{n-1}e^{-{x_j}^2}+e^{-x^2}\right]
				\end{equation}
			donde $h = x/n$ y $x_j = jh$.
		
		\item
			A continuación se encuentra el código en \emph{Octave} de la aproximación de la función error mediante polinomios de Taylor:
			\lstinputlisting[language=Octave]{erf_taylor.m}
			
			La función para la aproximación utilizando el método de los trapecios implementada en \emph{Octave} es:
			\lstinputlisting[language=Octave]{erf_trapecios.m}

			Se pueden encontrar ambos archivos, \textit{erf\_taylor.m} y \textit{erf\_trapecios.m}, en la presente entrega.

			El módulo principal, \textit{ejercicio2.m}, realiza llamadas a ambos métodos variando el número de iteraciones para 
			cada método entre uno y diez, y calcula el error absoluto con respecto a la función \emph{erf} de \emph{Octave}.
			Como la aproximación por el método de los trapecios converge muy lentamente, se implementó una función que calcule el número 
			de iteraciones necesarias para lograr un número de cifras significativas, que es pasada por parámetros.
			Todos estos resultados se escriben en un archivo, \emph{resultados.txt}.
			\lstinputlisting[language=Octave]{ejercicio2.m}
		
		\item
			A continuación se muestran los resultados del archivo \emph{resultados.txt}:
			\lstinputlisting{resultados.txt}

	\end{enumerate}


\section{Parte 3}\label{sec:parte3}


\begin{thebibliography}{9} 
	\bibitem{error_function}
		Error Function - Wikipedia, \url{https://en.wikipedia.org/wiki/Error_function}
	
	\bibitem{burden1}
		Richard L. Burden, J. Douglas Faires, \emph{Numerical Analysis (9th edition)} \\
		Brooks/Cole, Cengage Learning, 2010, Sección 4.3, página 194

	\bibitem{burden2}
	Richard L. Burden, J. Douglas Faires, \emph{Numerical Analysis (9th edition)} \\
	Brooks/Cole, Cengage Learning, 2010, Sección 4.4, página 206
	 
\end{thebibliography}



\end{document}